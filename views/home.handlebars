<style>
    .panel-body .btn {
        margin-top: 6px;
    }
</style>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            {{#each collections}}
            <div class="panel panel-default">
                <div class="panel-body" style="width: 90%; padding: 0px 15px;">
                    <a href="/collection/{{id}}" style="text-decoration: none;">
                        <h4>{{name}} <small>{{id}}</small></h4>
                    </a>
                    <p>{{description}}</p>
                    <p>
                        {{#if_req status 'run'}}
                        <a data-name="{{name}}" data-id="{{id}}" data-action="stop" class="status-modal btn btn-success btn-xs">
                            <span>running</span>
                        </a>
                        {{else}}
                        <a data-name="{{name}}" data-id="{{id}}" data-action="run" class="status-modal btn btn-danger btn-xs">
                            <span>stop</span>
                        </a>
                        {{/if_req}}
                        {{#if last}}
                        <button class="btn btn-primary btn-xs" type="button" disabled="disabled">
                            Cost <span class="badge">{{last.cost}}ms</span>
                        </button>
                        <button type="button" class="btn btn-default btn-xs" disabled="disabled">
                            {{last.started}} - {{last.completed}}
                        </button>
                        <button class="btn btn-success btn-xs" type="button" disabled="disabled">
                            Assertions Success <span class="badge">{{last.assertions.success}}</span>
                        </button>
                        <button class="btn btn-danger btn-xs" type="button" disabled="disabled">
                            Assertions failure <span class="badge">{{last.assertions.failed}}</span>
                        </button>
                        <button class="btn btn-success btn-xs" type="button" disabled="disabled">
                            TestScripts Success <span class="badge">{{last.testScripts.success}}</span>
                        </button>
                        <button class="btn btn-danger btn-xs" type="button" disabled="disabled">
                            TestScripts failure <span class="badge">{{last.testScripts.failed}}</span>
                        </button>
                        {{/if}}
                        <a href="/collection/update/{{id}}" class="btn btn-warning btn-xs">
                            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                        </a>
                        <a data-name="{{name}}" data-id="{{id}}" class="del-modal btn btn-danger btn-xs">
                            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                        </a>
                    </p>
                </div>
            </div>
            {{/each}}
        </div>
        <div class="col-md-2"></div>
    </div>
</div>
<div id="confirm-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="gridSystemModalLabel">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridSystemModalLabel">Confirm Message</h4>
            </div>
            <div class="modal-body">
                <p></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">No</button>
                <button id="confirm-modal-yes" type="button" class="btn btn-primary" data-dismiss="modal">Yes</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<script>
  $('.del-modal').click(function(){
    $('#confirm-modal .modal-body p').text('delete ' + $(this).data('name'));
    var id = $(this).data('id');
    $('#confirm-modal-yes').click(function () {
      $.ajax({
        method: 'DELETE',
        url: '/collection/' + id
      }).done(function () {
        location.reload();
      })
    });
    $('#confirm-modal').modal();
  });
  $('.status-modal').click(function(){
    var id = $(this).data('id');
    var action = $(this).data('action');
    $('#confirm-modal .modal-body p').text(action + ' ' + $(this).data('name'));
    $('#confirm-modal-yes').click(function () {
      $.ajax({
        method: 'POST',
        url: '/collection/' + action + '/' + id
      }).done(function () {
        location.reload();
      })
    });
    $('#confirm-modal').modal();
  });
</script>
